<div class="pagination-wrapper">
    <nav aria-label="Page navigation">
        <ul class="pagination">
            <% if (currentPage > 1) { %>
                <li class="page-item">
                    <a class="page-link" href="?<%= buildQuery({ ...baseQuery, page: currentPage - 1 }) %>">Previous</a>
                </li>
            <% } %>

            <% 
                const pageRange = 7;
                let startPage = Math.max(1, currentPage - Math.floor(pageRange / 2));
                let endPage = Math.min(totalPages, currentPage + Math.floor(pageRange / 2));

                if (currentPage - Math.floor(pageRange / 2) < 1) {
                    endPage = Math.min(totalPages, endPage + (1 - (currentPage - Math.floor(pageRange / 2))));
                }

                if (currentPage + Math.floor(pageRange / 2) > totalPages) {
                    startPage = Math.max(1, startPage - ((currentPage + Math.floor(pageRange / 2)) - totalPages));
                }

                if (startPage > 1) {
            %>
                <li class="page-item">
                    <a class="page-link" href="?<%= buildQuery({ ...baseQuery, page: 1 }) %>">1</a>
                </li>
                <li class="page-item disabled">
                    <span class="page-link">...</span>
                </li>
            <% } %>

            <% for (let i = startPage; i <= endPage; i++) { %>
                <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                    <a class="page-link" href="?<%= buildQuery({ ...baseQuery, page: i }) %>" aria-current="<%= i === currentPage ? 'page' : undefined %>"><%= i %></a>
                </li>
            <% } %>

            <% if (endPage < totalPages) { %>
                <li class="page-item disabled">
                    <span class="page-link">...</span>
                </li>
                <li class="page-item">
                    <a class="page-link" href="?<%= buildQuery({ ...baseQuery, page: totalPages }) %>"><%= totalPages %></a>
                </li>
            <% } %>

            <% if (currentPage < totalPages) { %>
                <li class="page-item">
                    <a class="page-link" href="?<%= buildQuery({ ...baseQuery, page: currentPage + 1 }) %>">Next</a>
                </li>
            <% } %>
        </ul>
    </nav>
</div>
